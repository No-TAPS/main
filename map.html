<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Map - UCSC</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>

<body>
    <div class="sidebar">
        <div class="search-bar">
            <input type="text" class="search-input" id="parkingLotSearch" placeholder="Search by name, lot #, permit, ...">
            
            <div class="sidebar-container" id="permit-check-boxes">
            </div>

            <div class="sidebar-container" id="r-c-permits">
                <label>
                    R/C permits after 5 p.m.
                    <input id="rc-permit-check" type="checkbox">
                </label>
            </div>
            
            <div class="sidebar-container" id="pm-hourly">
                <label>ParkMobile Hourly</label>
                <select id="pm-hourly-select">
                    <option value="0.5">30 minutes</option>
                    <option value="1">1 hour</option>
                    <option value="2">2 hours</option>
                    <option value="3">3 hours</option>
                    <option value="5">5 hours</option>
                </select>
            </div>

            <div class="sidebar-container" id="pm-check-boxes">
                <label>
                    ParkMobile Daily
                    <input type="checkbox">
                </label>
                <label>
                    ParkMobile Eve / Wknd
                    <input type="checkbox">
                </label>
            </div>

            <button class="search-button" onclick="searchParkingLots()">Search</button>
        </div>
        
    </div>

    <div id="map"></div>

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="search.js"></script>
    <script src="leaflet.js"></script>
    <script>
        function searchParkingLots() {
            const permit_boxes = document.querySelector("#permit-check-boxes");
            const rc_permit_box = document.getElementById('rc-permit-check');
            const pm_hourly_select = document.getElementById('pm-hourly-select');
            const pm_boxes = document.querySelector('#pm-check-boxes');

            const checked_permits = permit_boxes.querySelectorAll('input[type="checkbox"]:checked');
            var permits_selected = Array.from(checked_permits).map(x => x.value)

            const checked_pm = pm_boxes.querySelectorAll('input[type="checkbox"]');
            var pm_selected = Array.from(checked_pm).map(x => x.checked);

            create_query(permits_selected, rc_permit_box.checked, pm_hourly_select.value, pm_selected);
        }
        const permits = ["A", "B", "C", "C111A", "C119", "C152", "C153", "C154", "C155", "C156", "C157", "C158", "C159", "C162", "C206", "C301", "R", "RMC", "EV", "MC", "N", "NC", "HC", "FSH", "Medical"];
        const checkbox = document.querySelector("#permit-check-boxes");

        permits.forEach(permit => {
            var element = document.createElement("label");
            element.setAttribute("class", "check-box-container");
            element.innerHTML = permit + `<input type="checkbox" value="` + permit + `">`;
            checkbox.appendChild(element);
        });

    </script>

</body>
</html>
